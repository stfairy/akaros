package main

import "fmt"
import "os"

var (
	bsdregs = map[string]int{
		//0x8000000000000000 : "CR3_PCID_SAVE",
		/*
		   "CR0_PE": 0x00000001,
		   "CR0_MP": 0x00000002,
		   "CR0_EM": 0x00000004,
		   "CR0_TS": 0x00000008,
		   "CR0_PG": 0x80000000,
		   "CR0_NE": 0x00000020,
		   "CR0_WP": 0x00010000,
		   "CR0_AM": 0x00040000,
		   "CR0_NW": 0x20000000 ,
		   "CR0_CD": 0x40000000 ,
		   "CR4_VME": 0x00000001,
		   "CR4_PVI": 0x00000002,
		   "CR4_TSD": 0x00000004,
		   "CR4_DE": 0x00000008,
		   "CR4_PSE": 0x00000010,
		   "CR4_PAE": 0x00000020,
		   "CR4_MCE": 0x00000040,
		   "CR4_PGE": 0x00000080,
		   "CR4_PCE": 0x00000100,
		   "CR4_FXSR": 0x00000200,
		   "CR4_XMM": 0x00000400,
		   "CR4_VMXE": 0x00002000 ,
		   "CR4_FSGSBASE": 0x00010000,
		   "CR4_PCIDE": 0x00020000,
		   "CR4_XSAVE": 0x00040000,
		   "CR4_SMEP": 0x00100000,
		   "EFER_LMA": 0x000000400,
		   "EFER_NXE": 0x000000800,
		   "EFER_SVM": 0x000001000,
		    0: "XCR0",
		   "XFEATURE_ENABLED_X87": 0x00000001,
		   "XFEATURE_ENABLED_SSE": 0x00000002,
		   "XFEATURE_ENABLED_YMM_HI128": 0x00000004,
		   "XFEATURE_ENABLED_AVX": 0x00000004,
		   "XFEATURE_ENABLED_BNDREGS": 0x00000008,
		   "XFEATURE_ENABLED_BNDCSR": 0x00000010,
		   "XFEATURE_ENABLED_OPMASK": 0x00000020,
		   "XFEATURE_ENABLED_ZMM_HI256": 0x00000040,
		   "XFEATURE_ENABLED_HI16_ZMM": 0x00000080,
		   "CPUID_FPU": 0x00000001,
		   "CPUID_VME": 0x00000002,
		   "CPUID_DE": 0x00000004,
		   "CPUID_PSE": 0x00000008,
		   "CPUID_TSC": 0x00000010,
		   "CPUID_MSR": 0x00000020,
		   "CPUID_PAE": 0x00000040,
		   "CPUID_MCE": 0x00000080,
		   "CPUID_CX8": 0x00000100,
		   "CPUID_APIC": 0x00000200,
		   "CPUID_B10": 0x00000400,
		   "CPUID_SEP": 0x00000800,
		   "CPUID_MTRR": 0x00001000,
		   "CPUID_PGE": 0x00002000,
		   "CPUID_MCA": 0x00004000,
		   "CPUID_CMOV": 0x00008000,
		   "CPUID_PAT": 0x00010000,
		   "CPUID_PSE36": 0x00020000,
		   "CPUID_PSN": 0x00040000,
		   "CPUID_CLFSH": 0x00080000,
		   "CPUID_B20": 0x00100000,
		   "CPUID_DS": 0x00200000,
		   "CPUID_ACPI": 0x00400000,
		   "CPUID_MMX": 0x00800000,
		   "CPUID_FXSR": 0x01000000,
		   "CPUID_SSE": 0x02000000,
		   "CPUID_XMM": 0x02000000,
		   "CPUID_SSE2": 0x04000000,
		   "CPUID_SS": 0x08000000,
		   "CPUID_HTT": 0x10000000,
		   "CPUID_TM": 0x20000000,
		   "CPUID_IA64": 0x40000000,
		   "CPUID_PBE": 0x80000000,
		   "CPUID2_SSE3": 0x00000001,
		   "CPUID2_PCLMULQDQ": 0x00000002,
		   "CPUID2_DTES64": 0x00000004,
		   "CPUID2_MON": 0x00000008,
		   "CPUID2_DS_CPL": 0x00000010,
		   "CPUID2_VMX": 0x00000020,
		   "CPUID2_SMX": 0x00000040,
		   "CPUID2_EST": 0x00000080,
		   "CPUID2_TM2": 0x00000100,
		   "CPUID2_SSSE3": 0x00000200,
		   "CPUID2_CNXTID": 0x00000400,
		   "CPUID2_SDBG": 0x00000800,
		   "CPUID2_FMA": 0x00001000,
		   "CPUID2_CX16": 0x00002000,
		   "CPUID2_XTPR": 0x00004000,
		   "CPUID2_PDCM": 0x00008000,
		   "CPUID2_PCID": 0x00020000,
		   "CPUID2_DCA": 0x00040000,
		   "CPUID2_SSE41": 0x00080000,
		   "CPUID2_SSE42": 0x00100000,
		   "CPUID2_X2APIC": 0x00200000,
		   "CPUID2_MOVBE": 0x00400000,
		   "CPUID2_POPCNT": 0x00800000,
		   "CPUID2_TSCDLT": 0x01000000,
		   "CPUID2_AESNI": 0x02000000,
		   "CPUID2_XSAVE": 0x04000000,
		   "CPUID2_OSXSAVE": 0x08000000,
		   "CPUID2_AVX": 0x10000000,
		   "CPUID2_F16C": 0x20000000,
		   "CPUID2_RDRAND": 0x40000000,
		   "CPUID2_HV": 0x80000000,
		   "CPUTPM1_SENSOR": 0x00000001,
		   "CPUTPM1_TURBO": 0x00000002,
		   "CPUTPM1_ARAT": 0x00000004,
		   "CPUTPM2_EFFREQ": 0x00000001,
		   "AMDID_SYSCALL": 0x00000800,
		   "AMDID_MP": 0x00080000,
		   "AMDID_NX": 0x00100000,
		   "AMDID_EXT_MMX": 0x00400000,
		   "AMDID_FFXSR": 0x01000000,
		   "AMDID_PAGE1GB": 0x04000000,
		   "AMDID_RDTSCP": 0x08000000,
		   "AMDID_LM": 0x20000000,
		   "AMDID_EXT_3DNOW": 0x40000000,
		   "AMDID_3DNOW": 0x80000000,
		   "AMDID2_LAHF": 0x00000001,
		   "AMDID2_CMP": 0x00000002,
		   "AMDID2_SVM": 0x00000004,
		   "AMDID2_EXT_APIC": 0x00000008,
		   "AMDID2_CR8": 0x00000010,
		   "AMDID2_ABM": 0x00000020,
		   "AMDID2_SSE4A": 0x00000040,
		   "AMDID2_MAS": 0x00000080,
		   "AMDID2_PREFETCH": 0x00000100,
		   "AMDID2_OSVW": 0x00000200,
		   "AMDID2_IBS": 0x00000400,
		   "AMDID2_XOP": 0x00000800,
		   "AMDID2_SKINIT": 0x00001000,
		   "AMDID2_WDT": 0x00002000,
		   "AMDID2_LWP": 0x00008000,
		   "AMDID2_FMA4": 0x00010000,
		   "AMDID2_TCE": 0x00020000,
		   "AMDID2_NODE_ID": 0x00080000,
		   "AMDID2_TBM": 0x00200000,
		   "AMDID2_TOPOLOGY": 0x00400000,
		   "AMDID2_PCXC": 0x00800000,
		   "AMDID2_PNXC": 0x01000000,
		   "AMDID2_DBE": 0x04000000,
		   "AMDID2_PTSC": 0x08000000,
		   "AMDID2_PTSCEL2I": 0x10000000,
		   "CPUID_STEPPING": 0x0000000f,
		   "CPUID_MODEL": 0x000000f0,
		   "CPUID_FAMILY": 0x00000f00,
		   "CPUID_EXT_MODEL": 0x000f0000,
		   "CPUID_EXT_FAMILY": 0x0ff00000,
		   "CPUID_BRAND_INDEX": 0x000000ff,
		   "CPUID_CLFUSH_SIZE": 0x0000ff00,
		   "CPUID_HTT_CORES": 0x00ff0000,
		   "CPUID_LOCAL_APIC_ID": 0xff000000,
		   "CPUID5_MON_MIN_SIZE": 0x0000ffff,
		   "CPUID5_MON_MAX_SIZE": 0x0000ffff,
		   "CPUID5_MON_MWAIT_EXT": 0x00000001,
		   "CPUID5_MWAIT_INTRBREAK": 0x00000002,
		   "MWAIT_C0": 0xf0,
		   "MWAIT_C1": 0x00,
		   "MWAIT_C2": 0x10,
		   "MWAIT_C3": 0x20,
		   "MWAIT_C4": 0x30,
		   "MWAIT_INTRBREAK": 0x00000001,
		   "CPUID_PERF_STAT": 0x00000001,
		   "CPUID_PERF_BIAS": 0x00000008,
		    0: "CPUID_TYPE_INVAL",
		    1: "CPUID_TYPE_SMT",
		    2: "CPUID_TYPE_CORE",
		   "CPUID_EXTSTATE_XSAVEOPT": 0x00000001,
		   "CPUID_EXTSTATE_XSAVEC": 0x00000002,
		   "CPUID_EXTSTATE_XINUSE": 0x00000004,
		   "CPUID_EXTSTATE_XSAVES": 0x00000008,
		   "AMDPM_TS": 0x00000001,
		   "AMDPM_FID": 0x00000002,
		   "AMDPM_VID": 0x00000004,
		   "AMDPM_TTP": 0x00000008,
		   "AMDPM_TM": 0x00000010,
		   "AMDPM_STC": 0x00000020,
		   "AMDPM_100MHZ_STEPS": 0x00000040,
		   "AMDPM_HW_PSTATE": 0x00000080,
		   "AMDPM_TSC_INVARIANT": 0x00000100,
		   "AMDPM_CPB": 0x00000200,
		   "AMDID_CMP_CORES": 0x000000ff,
		   "AMDID_COREID_SIZE": 0x0000f000,
		    12: "AMDID_COREID_SIZE_SHIFT",
		   "CPUID_STDEXT_FSGSBASE": 0x00000001,
		   "CPUID_STDEXT_TSC_ADJUST": 0x00000002,
		   "CPUID_STDEXT_BMI1": 0x00000008,
		   "CPUID_STDEXT_HLE": 0x00000010,
		   "CPUID_STDEXT_AVX2": 0x00000020,
		   "CPUID_STDEXT_SMEP": 0x00000080,
		   "CPUID_STDEXT_BMI2": 0x00000100,
		   "CPUID_STDEXT_ERMS": 0x00000200,
		   "CPUID_STDEXT_INVPCID": 0x00000400,
		   "CPUID_STDEXT_RTM": 0x00000800,
		   "CPUID_STDEXT_MPX": 0x00004000,
		   "CPUID_STDEXT_AVX512F": 0x00010000,
		   "CPUID_STDEXT_RDSEED": 0x00040000,
		   "CPUID_STDEXT_ADX": 0x00080000,
		   "CPUID_STDEXT_SMAP": 0x00100000,
		   "CPUID_STDEXT_CLFLUSHOPT": 0x00800000,
		   "CPUID_STDEXT_PROCTRACE": 0x02000000,
		   "CPUID_STDEXT_AVX512PF": 0x04000000,
		   "CPUID_STDEXT_AVX512ER": 0x08000000,
		   "CPUID_STDEXT_AVX512CD": 0x10000000,
		   "CPUID_STDEXT_SHA": 0x20000000,
		*/
		"MSR_P5_MC_ADDR":              0x000,
		"MSR_P5_MC_TYPE":              0x001,
		"MSR_TSC":                     0x010,
		"MSR_P5_CESR":                 0x011,
		"MSR_P5_CTR0":                 0x012,
		"MSR_P5_CTR1":                 0x013,
		"MSR_APICBASE":                0x01b,
		"MSR_EBL_CR_POWERON":          0x02a,
		"MSR_TEST_CTL":                0x033,
		"MSR_BIOS_UPDT_TRIG":          0x079,
		"MSR_BBL_CR_D0":               0x088,
		"MSR_BBL_CR_D1":               0x089,
		"MSR_BBL_CR_D2":               0x08a,
		"MSR_BIOS_SIGN":               0x08b,
		"MSR_PERFCTR0":                0x0c1,
		"MSR_PERFCTR1":                0x0c2,
		"MSR_PLATFORM_INFO":           0x0ce,
		"MSR_MPERF":                   0x0e7,
		"MSR_APERF":                   0x0e8,
		"MSR_IA32_EXT_CONFIG":         0x0ee,
		"MSR_BBL_CR_ADDR":             0x116,
		"MSR_BBL_CR_DECC":             0x118,
		"MSR_BBL_CR_CTL":              0x119,
		"MSR_BBL_CR_TRIG":             0x11a,
		"MSR_BBL_CR_BUSY":             0x11b,
		"MSR_BBL_CR_CTL3":             0x11e,
		"MSR_SYSENTER_CS_MSR":         0x174,
		"MSR_SYSENTER_ESP_MSR":        0x175,
		"MSR_SYSENTER_EIP_MSR":        0x176,
		"MSR_MCG_CAP":                 0x179,
		"MSR_MCG_STATUS":              0x17a,
		"MSR_MCG_CTL":                 0x17b,
		"MSR_EVNTSEL0":                0x186,
		"MSR_EVNTSEL1":                0x187,
		"MSR_THERM_CONTROL":           0x19a,
		"MSR_THERM_INTERRUPT":         0x19b,
		"MSR_THERM_STATUS":            0x19c,
		"MSR_TURBO_RATIO_LIMIT":       0x1ad,
		"MSR_TURBO_RATIO_LIMIT1":      0x1ae,
		"MSR_DEBUGCTLMSR":             0x1d9,
		"MSR_LASTBRANCHFROMIP":        0x1db,
		"MSR_LASTBRANCHTOIP":          0x1dc,
		"MSR_LASTINTFROMIP":           0x1dd,
		"MSR_LASTINTTOIP":             0x1de,
		"MSR_ROB_CR_BKUPTMPDR6":       0x1e0,
		"MSR_MTRRVarBase":             0x200,
		"MSR_MTRR64kBase":             0x250,
		"MSR_MTRR16kBase":             0x258,
		"MSR_MTRR4kBase":              0x268,
		"MSR_PAT":                     0x277,
		"MSR_MC0_CTL2":                0x280,
		"MSR_MTRRdefType":             0x2ff,
		"MSR_MC0_CTL":                 0x400,
		"MSR_MC0_STATUS":              0x401,
		"MSR_MC0_ADDR":                0x402,
		"MSR_MC0_MISC":                0x403,
		"MSR_MC1_CTL":                 0x404,
		"MSR_MC1_STATUS":              0x405,
		"MSR_MC1_ADDR":                0x406,
		"MSR_MC1_MISC":                0x407,
		"MSR_MC2_CTL":                 0x408,
		"MSR_MC2_STATUS":              0x409,
		"MSR_MC2_ADDR":                0x40a,
		"MSR_MC2_MISC":                0x40b,
		"MSR_MC3_CTL":                 0x40c,
		"MSR_MC3_STATUS":              0x40d,
		"MSR_MC3_ADDR":                0x40e,
		"MSR_MC3_MISC":                0x40f,
		"MSR_MC4_CTL":                 0x410,
		"MSR_MC4_STATUS":              0x411,
		"MSR_MC4_ADDR":                0x412,
		"MSR_MC4_MISC":                0x413,
		"MSR_VMX_BASIC":               0x480,
		"MSR_VMX_PINBASED_CTLS":       0x481,
		"MSR_VMX_PROCBASED_CTLS":      0x482,
		"MSR_VMX_EXIT_CTLS":           0x483,
		"MSR_VMX_ENTRY_CTLS":          0x484,
		"MSR_VMX_CR0_FIXED0":          0x486,
		"MSR_VMX_CR0_FIXED1":          0x487,
		"MSR_VMX_CR4_FIXED0":          0x488,
		"MSR_VMX_CR4_FIXED1":          0x489,
		"MSR_VMX_PROCBASED_CTLS2":     0x48b,
		"MSR_VMX_EPT_VPID_CAP":        0x48c,
		"MSR_VMX_TRUE_PINBASED_CTLS":  0x48d,
		"MSR_VMX_TRUE_PROCBASED_CTLS": 0x48e,
		"MSR_VMX_TRUE_EXIT_CTLS":      0x48f,
		"MSR_VMX_TRUE_ENTRY_CTLS":     0x490,
		"MSR_APIC_ID":                 0x802,
		"MSR_APIC_VERSION":            0x803,
		"MSR_APIC_TPR":                0x808,
		"MSR_APIC_EOI":                0x80b,
		"MSR_APIC_LDR":                0x80d,
		"MSR_APIC_SVR":                0x80f,
		"MSR_APIC_ISR0":               0x810,
		"MSR_APIC_ISR1":               0x811,
		"MSR_APIC_ISR2":               0x812,
		"MSR_APIC_ISR3":               0x813,
		"MSR_APIC_ISR4":               0x814,
		"MSR_APIC_ISR5":               0x815,
		"MSR_APIC_ISR6":               0x816,
		"MSR_APIC_ISR7":               0x817,
		"MSR_APIC_TMR0":               0x818,
		"MSR_APIC_IRR0":               0x820,
		"MSR_APIC_ESR":                0x828,
		"MSR_APIC_LVT_CMCI":           0x82F,
		"MSR_APIC_ICR":                0x830,
		"MSR_APIC_LVT_TIMER":          0x832,
		"MSR_APIC_LVT_THERMAL":        0x833,
		"MSR_APIC_LVT_PCINT":          0x834,
		"MSR_APIC_LVT_LINT0":          0x835,
		"MSR_APIC_LVT_LINT1":          0x836,
		"MSR_APIC_LVT_ERROR":          0x837,
		"MSR_APIC_ICR_TIMER":          0x838,
		"MSR_APIC_CCR_TIMER":          0x839,
		"MSR_APIC_DCR_TIMER":          0x83e,
		"MSR_APIC_SELF_IPI":           0x83f,
		"MSR_IA32_XSS":                0xda0,
		/*
		   "APICBASE_RESERVED": 0x000002ff,
		   "APICBASE_BSP": 0x00000100,
		   "APICBASE_X2APIC": 0x00000400,
		   "APICBASE_ENABLED": 0x00000800,
		   "APICBASE_ADDRESS": 0xfffff000,
		   "IA32_FEATURE_CONTROL_LOCK": 0x01,
		   "IA32_FEATURE_CONTROL_SMX_EN": 0x02,
		   "PAT_UNCACHEABLE": 0x00,
		   "PAT_WRITE_COMBINING": 0x01,
		   "PAT_WRITE_THROUGH": 0x04,
		   "PAT_WRITE_PROTECTED": 0x05,
		   "PAT_WRITE_BACK": 0x06,
		   "PAT_UNCACHED": 0x07,
		   "MTRR_UNCACHEABLE": 0x00,
		   "MTRR_WRITE_COMBINING": 0x01,
		   "MTRR_WRITE_THROUGH": 0x04,
		   "MTRR_WRITE_PROTECTED": 0x05,
		   "MTRR_WRITE_BACK": 0x06,
		    8: "MTRR_N64K",
		    16: "MTRR_N16K",
		    64: "MTRR_N4K",
		   "MTRR_CAP_WC": 0x0000000000000400,
		   "MTRR_CAP_FIXED": 0x0000000000000100,
		   "MTRR_CAP_VCNT": 0x00000000000000ff,
		   "MTRR_DEF_ENABLE": 0x0000000000000800,
		   "MTRR_DEF_FIXED_ENABLE": 0x0000000000000400,
		   "MTRR_DEF_TYPE": 0x00000000000000ff,
		   "MTRR_PHYSBASE_PHYSBASE": 0x000ffffffffff000,
		   "MTRR_PHYSBASE_TYPE": 0x00000000000000ff,
		   "MTRR_PHYSMASK_PHYSMASK": 0x000ffffffffff000,
		   "MTRR_PHYSMASK_VALID": 0x0000000000000800,
		   "CCR0": 0xc0,
		   "CCR0_NC0": 0x01,
		   "CCR0_NC1": 0x02,
		   "CCR0_A20M": 0x04,
		   "CCR0_KEN": 0x08,
		   "CCR0_FLUSH": 0x10,
		   "CCR0_BARB": 0x20,
		   "CCR0_CO": 0x40,
		   "CCR0_SUSPEND": 0x80,
		   "CCR1": 0xc1,
		   "CCR1_RPL": 0x01,
		   "CCR1_SMI": 0x02,
		   "CCR1_SMAC": 0x04,
		   "CCR1_MMAC": 0x08,
		   "CCR1_NO_LOCK": 0x10,
		   "CCR1_SM3": 0x80,
		   "CCR2": 0xc2,
		   "CCR2_WB": 0x02,
		   "CCR2_SADS": 0x02,
		   "CCR2_LOCK_NW": 0x04,
		   "CCR2_SUSP_HLT": 0x08,
		   "CCR2_WT1": 0x10,
		   "CCR2_WPR1": 0x10,
		   "CCR2_BARB": 0x20,
		   "CCR2_BWRT": 0x40,
		   "CCR2_USE_SUSP": 0x80,
		   "CCR3": 0xc3,
		   "CCR3_SMILOCK": 0x01,
		   "CCR3_NMI": 0x02,
		   "CCR3_LINBRST": 0x04,
		   "CCR3_SMMMODE": 0x08,
		   "CCR3_MAPEN0": 0x10,
		   "CCR3_MAPEN1": 0x20,
		   "CCR3_MAPEN2": 0x40,
		   "CCR3_MAPEN3": 0x80,
		   "CCR4": 0xe8,
		   "CCR4_IOMASK": 0x07,
		   "CCR4_MEM": 0x08,
		   "CCR4_DTE": 0x10,
		   "CCR4_FASTFPE": 0x20,
		   "CCR4_CPUID": 0x80,
		   "CCR5": 0xe9,
		   "CCR5_WT_ALLOC": 0x01,
		   "CCR5_SLOP": 0x02,
		   "CCR5_LBR1": 0x10,
		   "CCR5_ARREN": 0x20,
		   "CCR6": 0xea,
		   "CCR7": 0xeb,
		   "PCR0": 0x20,
		   "PCR0_RSTK": 0x01,
		   "PCR0_BTB": 0x02,
		   "PCR0_LOOP": 0x04,
		   "PCR0_AIS": 0x08,
		   "PCR0_MLR": 0x10,
		   "PCR0_BTBRT": 0x40,
		   "PCR0_LSSER": 0x80,
		   "DIR0": 0xfe,
		   "DIR1": 0xff,
		   "MCG_CAP_COUNT": 0x000000ff,
		   "MCG_CAP_CTL_P": 0x00000100,
		   "MCG_CAP_EXT_P": 0x00000200,
		   "MCG_CAP_CMCI_P": 0x00000400,
		   "MCG_CAP_TES_P": 0x00000800,
		   "MCG_CAP_EXT_CNT": 0x00ff0000,
		   "MCG_CAP_SER_P": 0x01000000,
		   "MCG_STATUS_RIPV": 0x00000001,
		   "MCG_STATUS_EIPV": 0x00000002,
		   "MCG_STATUS_MCIP": 0x00000004,
		   "MCG_CTL_ENABLE": 0xffffffffffffffff,
		   "MCG_CTL_DISABLE": 0x0000000000000000,
		   "MC_STATUS_MCA_ERROR": 0x000000000000ffff,
		   "MC_STATUS_MODEL_ERROR": 0x00000000ffff0000,
		   "MC_STATUS_OTHER_INFO": 0x01ffffff00000000,
		   "MC_STATUS_COR_COUNT": 0x001fffc000000000,
		   "MC_STATUS_TES_STATUS": 0x0060000000000000,
		   "MC_STATUS_AR": 0x0080000000000000,
		   "MC_STATUS_S": 0x0100000000000000,
		   "MC_STATUS_PCC": 0x0200000000000000,
		   "MC_STATUS_ADDRV": 0x0400000000000000,
		   "MC_STATUS_MISCV": 0x0800000000000000,
		   "MC_STATUS_EN": 0x1000000000000000,
		   "MC_STATUS_UC": 0x2000000000000000,
		   "MC_STATUS_OVER": 0x4000000000000000,
		   "MC_STATUS_VAL": 0x8000000000000000,
		   "MC_MISC_RA_LSB": 0x000000000000003f,
		   "MC_MISC_ADDRESS_MODE": 0x00000000000001c0,
		   "MC_CTL2_THRESHOLD": 0x0000000000007fff,
		   "MC_CTL2_CMCI_EN": 0x0000000040000000,
		   "NCR1": 0xc4,
		   "NCR2": 0xc7,
		   "NCR3": 0xca,
		   "NCR4": 0xcd,
		    0: "NCR_SIZE_0K",
		    1: "NCR_SIZE_4K",
		    2: "NCR_SIZE_8K",
		    3: "NCR_SIZE_16K",
		    4: "NCR_SIZE_32K",
		    5: "NCR_SIZE_64K",
		    6: "NCR_SIZE_128K",
		    7: "NCR_SIZE_256K",
		    8: "NCR_SIZE_512K",
		    9: "NCR_SIZE_1M",
		    10: "NCR_SIZE_2M",
		    11: "NCR_SIZE_4M",
		    12: "NCR_SIZE_8M",
		    13: "NCR_SIZE_16M",
		    14: "NCR_SIZE_32M",
		    15: "NCR_SIZE_4G",
		   "ARR0": 0xc4,
		   "ARR1": 0xc7,
		   "ARR2": 0xca,
		   "ARR3": 0xcd,
		   "ARR4": 0xd0,
		   "ARR5": 0xd3,
		   "ARR6": 0xd6,
		   "ARR7": 0xd9,
		    0: "ARR_SIZE_0K",
		    1: "ARR_SIZE_4K",
		    2: "ARR_SIZE_8K",
		    3: "ARR_SIZE_16K",
		    4: "ARR_SIZE_32K",
		    5: "ARR_SIZE_64K",
		    6: "ARR_SIZE_128K",
		    7: "ARR_SIZE_256K",
		    8: "ARR_SIZE_512K",
		    9: "ARR_SIZE_1M",
		    10: "ARR_SIZE_2M",
		    11: "ARR_SIZE_4M",
		    12: "ARR_SIZE_8M",
		    13: "ARR_SIZE_16M",
		    14: "ARR_SIZE_32M",
		    15: "ARR_SIZE_4G",
		   "RCR0": 0xdc,
		   "RCR1": 0xdd,
		   "RCR2": 0xde,
		   "RCR3": 0xdf,
		   "RCR4": 0xe0,
		   "RCR5": 0xe1,
		   "RCR6": 0xe2,
		   "RCR7": 0xe3,
		   "RCR_RCD": 0x01,
		   "RCR_RCE": 0x01,
		   "RCR_WWO": 0x02,
		   "RCR_WL": 0x04,
		   "RCR_WG": 0x08,
		   "RCR_WT": 0x10,
		   "RCR_NLB": 0x20,
		   "AMD_WT_ALLOC_TME": 0x40000,
		   "AMD_WT_ALLOC_PRE": 0x20000,
		   "AMD_WT_ALLOC_FRE": 0x10000,
		*/
		"MSR_EFER":            0xc0000080,
		"MSR_STAR":            0xc0000081,
		"MSR_LSTAR":           0xc0000082,
		"MSR_CSTAR":           0xc0000083,
		"MSR_SF_MASK":         0xc0000084,
		"MSR_FSBASE":          0xc0000100,
		"MSR_GSBASE":          0xc0000101,
		"MSR_KGSBASE":         0xc0000102,
		"MSR_PERFEVSEL0":      0xc0010000,
		"MSR_PERFEVSEL1":      0xc0010001,
		"MSR_PERFEVSEL2":      0xc0010002,
		"MSR_PERFEVSEL3":      0xc0010003,
		"MSR_K7_PERFCTR0":     0xc0010004,
		"MSR_K7_PERFCTR1":     0xc0010005,
		"MSR_K7_PERFCTR2":     0xc0010006,
		"MSR_K7_PERFCTR3":     0xc0010007,
		"MSR_SYSCFG":          0xc0010010,
		"MSR_HWCR":            0xc0010015,
		"MSR_IORRBASE0":       0xc0010016,
		"MSR_IORRMASK0":       0xc0010017,
		"MSR_IORRBASE1":       0xc0010018,
		"MSR_IORRMASK1":       0xc0010019,
		"MSR_TOP_MEM":         0xc001001a,
		"MSR_TOP_MEM2":        0xc001001d,
		"MSR_NB_CFG1":         0xc001001f,
		"MSR_P_STATE_LIMIT":   0xc0010061,
		"MSR_P_STATE_CONTROL": 0xc0010062,
		"MSR_P_STATE_STATUS":  0xc0010063,
		"MSR_SMM_ADDR":        0xc0010112,
		"MSR_SMM_MASK":        0xc0010113,
		"MSR_IC_CFG":          0xc0011021,
		"MSR_K8_UCODE_UPDATE": 0xc0010020,
		"MSR_MC0_CTL_MASK":    0xc0010044,
		"MSR_VM_CR":           0xc0010114,
		"MSR_VM_HSAVE_PA":     0xc0010117,
		/*
		   "VM_CR_SVMDIS": 0x10,
		    1: "VIA_HAS_RNG",
		    1: "VIA_HAS_AES",
		    2: "VIA_HAS_SHA",
		    4: "VIA_HAS_MM",
		    8: "VIA_HAS_AESCTR",
		   "VIA_CPUID_HAS_RNG": 0x000004,
		   "VIA_CPUID_DO_RNG": 0x000008,
		   "VIA_CPUID_HAS_ACE": 0x000040,
		   "VIA_CPUID_DO_ACE": 0x000080,
		   "VIA_CPUID_HAS_ACE2": 0x000100,
		   "VIA_CPUID_DO_ACE2": 0x000200,
		   "VIA_CPUID_HAS_PHE": 0x000400,
		   "VIA_CPUID_DO_PHE": 0x000800,
		   "VIA_CPUID_HAS_PMM": 0x001000,
		   "VIA_CPUID_DO_PMM": 0x002000,
		   "VIA_CRYPT_CWLO_ROUND_M": 0x0000000f,
		   "VIA_CRYPT_CWLO_ALG_M": 0x00000070,
		   "VIA_CRYPT_CWLO_ALG_AES": 0x00000000,
		   "VIA_CRYPT_CWLO_KEYGEN_M": 0x00000080,
		   "VIA_CRYPT_CWLO_KEYGEN_HW": 0x00000000,
		   "VIA_CRYPT_CWLO_KEYGEN_SW": 0x00000080,
		   "VIA_CRYPT_CWLO_NORMAL": 0x00000000,
		   "VIA_CRYPT_CWLO_INTERMEDIATE": 0x00000100,
		   "VIA_CRYPT_CWLO_ENCRYPT": 0x00000000,
		   "VIA_CRYPT_CWLO_DECRYPT": 0x00000200,
		   "VIA_CRYPT_CWLO_KEY128": 0x0000000a,
		   "VIA_CRYPT_CWLO_KEY192": 0x0000040c,
		   "VIA_CRYPT_CWLO_KEY256": 0x0000080e,
		*/
	}
	aregs = map[int]string{
		0xc0000080: "MSR_EFER",
		0xc0000081: "MSR_STAR",
		0xc0000082: "MSR_LSTAR",
		0xc0000083: "MSR_CSTAR",
		0xc0000084: "MSR_SYSCALL_MASK",
		0xc0000100: "MSR_FS_BASE",
		0xc0000101: "MSR_GS_BASE",
		0xc0000102: "MSR_KERNEL_GS_BASE",
		0xc0000103: "MSR_TSC_AUX",
		/*
		   0: "_EFER_SCE",
		   8: "_EFER_LME",
		   10: "_EFER_LMA",
		   11: "_EFER_NX",
		   12: "_EFER_SVME",
		   13: "_EFER_LMSLE",
		   14: "_EFER_FFXSR",
		   (1<<0): "EFER_SCE",
		   (1<<8): "EFER_LME",
		   (1<<11): "EFER_NX",
		   (1<<12): "EFER_SVME",
		   (1<<13): "EFER_LMSLE",
		   (1<<14): "EFER_FFXSR",
		*/
		0x000000c1: "MSR_IA32_PERFCTR0",
		0x000000c2: "MSR_IA32_PERFCTR1",
		0x000000cd: "MSR_FSB_FREQ",
		0x000000ce: "MSR_NHM_PLATFORM_INFO",
		0x000000e2: "MSR_NHM_SNB_PKG_CST_CFG_CTL",
		/*
		   (1 << 25): "NHM_C3_AUTO_DEMOTE",
		   (1 << 26): "NHM_C1_AUTO_DEMOTE",
		   (1 << 25): "ATM_LNC_C6_AUTO_DEMOTE",
		   (1 << 27): "SNB_C1_AUTO_UNDEMOTE",
		   (1 << 28): "SNB_C3_AUTO_UNDEMOTE",
		*/
		0x000000fe: "MSR_MTRRcap",
		0x00000119: "MSR_IA32_BBL_CR_CTL",
		0x0000011e: "MSR_IA32_BBL_CR_CTL3",
		0x00000174: "MSR_IA32_SYSENTER_CS",
		0x00000175: "MSR_IA32_SYSENTER_ESP",
		0x00000176: "MSR_IA32_SYSENTER_EIP",
		0x00000179: "MSR_IA32_MCG_CAP",
		0x0000017a: "MSR_IA32_MCG_STATUS",
		0x0000017b: "MSR_IA32_MCG_CTL",
		0x000001a6: "MSR_OFFCORE_RSP_0",
		0x000001a7: "MSR_OFFCORE_RSP_1",
		0x000001ad: "MSR_NHM_TURBO_RATIO_LIMIT",
		0x000001ae: "MSR_IVT_TURBO_RATIO_LIMIT",
		0x000001c8: "MSR_LBR_SELECT",
		0x000001c9: "MSR_LBR_TOS",
		0x00000680: "MSR_LBR_NHM_FROM",
		0x000006c0: "MSR_LBR_NHM_TO",
		0x00000040: "MSR_LBR_CORE_FROM",
		0x00000060: "MSR_LBR_CORE_TO",
		0x000003f1: "MSR_IA32_PEBS_ENABLE",
		0x00000600: "MSR_IA32_DS_AREA",
		0x00000345: "MSR_IA32_PERF_CAPABILITIES",
		0x00000250: "MSR_MTRRfix64K_00000",
		0x00000258: "MSR_MTRRfix16K_80000",
		0x00000259: "MSR_MTRRfix16K_A0000",
		0x00000268: "MSR_MTRRfix4K_C0000",
		0x00000269: "MSR_MTRRfix4K_C8000",
		0x0000026a: "MSR_MTRRfix4K_D0000",
		0x0000026b: "MSR_MTRRfix4K_D8000",
		0x0000026c: "MSR_MTRRfix4K_E0000",
		0x0000026d: "MSR_MTRRfix4K_E8000",
		0x0000026e: "MSR_MTRRfix4K_F0000",
		0x0000026f: "MSR_MTRRfix4K_F8000",
		0x00000277: "MSR_IA32_CR_PAT",
		0x000001d9: "MSR_IA32_DEBUGCTLMSR",
		0x000001db: "MSR_IA32_LASTBRANCHFROMIP",
		0x000001dc: "MSR_IA32_LASTBRANCHTOIP",
		0x000001dd: "MSR_IA32_LASTINTFROMIP",
		0x000001de: "MSR_IA32_LASTINTTOIP",
		/*
		   (1 << 0): "DEBUGCTLMSR_LBR",
		   (1 << 1): "DEBUGCTLMSR_BTF",
		   (1 << 6): "DEBUGCTLMSR_TR",
		   (1 << 7): "DEBUGCTLMSR_BTS",
		   (1 << 8): "DEBUGCTLMSR_BTINT",
		   (1 << 9): "DEBUGCTLMSR_BTS_OFF_OS",
		   (1 << 10): "DEBUGCTLMSR_BTS_OFF_USR",
		   (1 << 11): "DEBUGCTLMSR_FREEZE_LBRS_ON_PMI",
		*/
		0x00000400: "MSR_IA32_MC0_CTL",
		0x00000401: "MSR_IA32_MC0_STATUS",
		0x00000402: "MSR_IA32_MC0_ADDR",
		0x00000403: "MSR_IA32_MC0_MISC",
		0x000003f8: "MSR_PKG_C3_RESIDENCY",
		0x000003f9: "MSR_PKG_C6_RESIDENCY",
		0x000003fa: "MSR_PKG_C7_RESIDENCY",
		0x000003fc: "MSR_CORE_C3_RESIDENCY",
		0x000003fd: "MSR_CORE_C6_RESIDENCY",
		0x000003fe: "MSR_CORE_C7_RESIDENCY",
		0x0000060d: "MSR_PKG_C2_RESIDENCY",
		0x00000630: "MSR_PKG_C8_RESIDENCY",
		0x00000631: "MSR_PKG_C9_RESIDENCY",
		0x00000632: "MSR_PKG_C10_RESIDENCY",
		0x00000606: "MSR_RAPL_POWER_UNIT",
		0x00000610: "MSR_PKG_POWER_LIMIT",
		0x00000611: "MSR_PKG_ENERGY_STATUS",
		0x00000613: "MSR_PKG_PERF_STATUS",
		0x00000614: "MSR_PKG_POWER_INFO",
		0x00000618: "MSR_DRAM_POWER_LIMIT",
		0x00000619: "MSR_DRAM_ENERGY_STATUS",
		0x0000061b: "MSR_DRAM_PERF_STATUS",
		0x0000061c: "MSR_DRAM_POWER_INFO",
		0x00000638: "MSR_PP0_POWER_LIMIT",
		0x00000639: "MSR_PP0_ENERGY_STATUS",
		0x0000063a: "MSR_PP0_POLICY",
		0x0000063b: "MSR_PP0_PERF_STATUS",
		0x00000640: "MSR_PP1_POWER_LIMIT",
		0x00000641: "MSR_PP1_ENERGY_STATUS",
		0x00000642: "MSR_PP1_POLICY",
		0xc0010044: "MSR_AMD64_MC0_MASK",
		0x00000280: "MSR_IA32_MC0_CTL2",
		// //0x000000c1: "MSR_P6_PERFCTR0",
		// //0x000000c2: "MSR_P6_PERFCTR1",
		// 0x00000186: "MSR_P6_EVNTSEL0",
		// 0x00000187: "MSR_P6_EVNTSEL1",
		0x00000020: "MSR_KNC_PERFCTR0",
		0x00000021: "MSR_KNC_PERFCTR1",
		0x00000028: "MSR_KNC_EVNTSEL0",
		0x00000029: "MSR_KNC_EVNTSEL1",
		0x0000008b: "MSR_AMD64_PATCH_LEVEL",
		0xc0000104: "MSR_AMD64_TSC_RATIO",
		0xc001001f: "MSR_AMD64_NB_CFG",
		0xc0010020: "MSR_AMD64_PATCH_LOADER",
		0xc0010140: "MSR_AMD64_OSVW_ID_LENGTH",
		0xc0010141: "MSR_AMD64_OSVW_STATUS",
		0xc0011022: "MSR_AMD64_DC_CFG",
		0xc0011030: "MSR_AMD64_IBSFETCHCTL",
		0xc0011031: "MSR_AMD64_IBSFETCHLINAD",
		0xc0011032: "MSR_AMD64_IBSFETCHPHYSAD",
		/*
		   3: "MSR_AMD64_IBSFETCH_REG_COUNT",
		   ((1<<3)-1): "MSR_AMD64_IBSFETCH_REG_MASK",
		*/
		0xc0011033: "MSR_AMD64_IBSOPCTL",
		0xc0011034: "MSR_AMD64_IBSOPRIP",
		0xc0011035: "MSR_AMD64_IBSOPDATA",
		0xc0011036: "MSR_AMD64_IBSOPDATA2",
		0xc0011037: "MSR_AMD64_IBSOPDATA3",
		0xc0011038: "MSR_AMD64_IBSDCLINAD",
		0xc0011039: "MSR_AMD64_IBSDCPHYSAD",
		/*
		   7: "MSR_AMD64_IBSOP_REG_COUNT",
		   ((1<<7)-1): "MSR_AMD64_IBSOP_REG_MASK",
		*/
		0xc001103a: "MSR_AMD64_IBSCTL",
		0xc001103b: "MSR_AMD64_IBSBRTARGET",
		// 8: "MSR_AMD64_IBS_REG_COUNT_MAX",
		0xc0010200: "MSR_F15H_PERF_CTL",
		0xc0010201: "MSR_F15H_PERF_CTR",
		0xc0010058: "MSR_FAM10H_MMIO_CONF_BASE",
		// (1<<0): "FAM10H_MMIO_CONF_ENABLE",
		// 0xf: "FAM10H_MMIO_CONF_BUSRANGE_MASK",
		// 2: "FAM10H_MMIO_CONF_BUSRANGE_SHIFT",
		// 0xfffffff: "FAM10H_MMIO_CONF_BASE_MASK",
		// 20: "FAM10H_MMIO_CONF_BASE_SHIFT",
		0xc001100c: "MSR_FAM10H_NODE_ID",
		0xc001001a: "MSR_K8_TOP_MEM1",
		0xc001001d: "MSR_K8_TOP_MEM2",
		0xc0010010: "MSR_K8_SYSCFG",
		0xc0010055: "MSR_K8_INT_PENDING_MSG",
		0x18000000: "K8_INTP_C1E_ACTIVE_MASK",
		0xc0010112: "MSR_K8_TSEG_ADDR",
		0x00040000: "K8_MTRRFIXRANGE_DRAM_ENABLE",
		0x00080000: "K8_MTRRFIXRANGE_DRAM_MODIFY",
		0x18181818: "K8_MTRR_RDMEM_WRMEM_MASK",
		0xc0010000: "MSR_K7_EVNTSEL0",
		0xc0010004: "MSR_K7_PERFCTR0",
		0xc0010001: "MSR_K7_EVNTSEL1",
		0xc0010005: "MSR_K7_PERFCTR1",
		0xc0010002: "MSR_K7_EVNTSEL2",
		0xc0010006: "MSR_K7_PERFCTR2",
		0xc0010003: "MSR_K7_EVNTSEL3",
		0xc0010007: "MSR_K7_PERFCTR3",
		0xc001001b: "MSR_K7_CLK_CTL",
		0xc0010015: "MSR_K7_HWCR",
		0xc0010041: "MSR_K7_FID_VID_CTL",
		0xc0010042: "MSR_K7_FID_VID_STATUS",
		// 0xc0000082: "MSR_K6_WHCR",
		// 0xc0000085: "MSR_K6_UWCCR",
		// 0xc0000086: "MSR_K6_EPMR",
		// 0xc0000087: "MSR_K6_PSOR",
		// 0xc0000088: "MSR_K6_PFIR",
		0x00000107: "MSR_IDT_FCR1",
		0x00000108: "MSR_IDT_FCR2",
		0x00000109: "MSR_IDT_FCR3",
		0x0000010a: "MSR_IDT_FCR4",
		0x00000110: "MSR_IDT_MCR0",
		0x00000111: "MSR_IDT_MCR1",
		0x00000112: "MSR_IDT_MCR2",
		0x00000113: "MSR_IDT_MCR3",
		0x00000114: "MSR_IDT_MCR4",
		0x00000115: "MSR_IDT_MCR5",
		0x00000116: "MSR_IDT_MCR6",
		0x00000117: "MSR_IDT_MCR7",
		0x00000120: "MSR_IDT_MCR_CTRL",
		0x00001107: "MSR_VIA_FCR",
		0x0000110a: "MSR_VIA_LONGHAUL",
		0x0000110b: "MSR_VIA_RNG",
		0x00001147: "MSR_VIA_BCR2",
		0x80868010: "MSR_TMTA_LONGRUN_CTRL",
		0x80868011: "MSR_TMTA_LONGRUN_FLAGS",
		0x80868018: "MSR_TMTA_LRTI_READOUT",
		0x8086801a: "MSR_TMTA_LRTI_VOLT_MHZ",
		0x00000000: "MSR_IA32_P5_MC_ADDR",
		0x00000001: "MSR_IA32_P5_MC_TYPE",
		0x00000010: "MSR_IA32_TSC",
		0x00000017: "MSR_IA32_PLATFORM_ID",
		0x0000002a: "MSR_IA32_EBL_CR_POWERON",
		0x0000002c: "MSR_EBC_FREQUENCY_ID",
		0x0000003a: "MSR_IA32_FEATURE_CONTROL",
		0x0000003b: "MSR_IA32_TSC_ADJUST",
		/*
		    (1<<0): "FEATURE_CONTROL_LOCKED",
		    (1<<1): "FEATURE_CONTROL_VMXON_ENABLED_INSIDE_SMX",
		    (1<<2): "FEATURE_CONTROL_VMXON_ENABLED_OUTSIDE_SMX",
		   /*
		    0x0000001b: "MSR_IA32_APICBASE",
		   // (1<<8): "MSR_IA32_APICBASE_BSP",
		   // (1<<11): "MSR_IA32_APICBASE_ENABLE",
		    0x000006e0: "MSR_IA32_TSCDEADLINE",
		    0x00000079: "MSR_IA32_UCODE_WRITE",
		    0x0000008b: "MSR_IA32_UCODE_REV",
		    0x00000198: "MSR_IA32_PERF_STATUS",
		    0x00000199: "MSR_IA32_PERF_CTL",
		    0xc0010064: "MSR_AMD_PSTATE_DEF_BASE",
		    0xc0010063: "MSR_AMD_PERF_STATUS",
		    0xc0010062: "MSR_AMD_PERF_CTL",
		    0x000000e7: "MSR_IA32_MPERF",
		    0x000000e8: "MSR_IA32_APERF",
		    0x0000019a: "MSR_IA32_THERM_CONTROL",
		    0x0000019b: "MSR_IA32_THERM_INTERRUPT",
		   /*
		    (1 << 0): "THERM_INT_HIGH_ENABLE",
		    (1 << 1): "THERM_INT_LOW_ENABLE",
		    (1 << 24): "THERM_INT_PLN_ENABLE",
		*/
		0x0000019c: "MSR_IA32_THERM_STATUS",
		// (1 << 0): "THERM_STATUS_PROCHOT",
		// (1 << 10): "THERM_STATUS_POWER_LIMIT",
		0x0000019d: "MSR_THERM2_CTL",
		// (1 << 16): "MSR_THERM2_CTL_TM_SELECT",
		0x000001a0: "MSR_IA32_MISC_ENABLE",
		0x000001a2: "MSR_IA32_TEMPERATURE_TARGET",
		0x000001b0: "MSR_IA32_ENERGY_PERF_BIAS",
		// 0: "ENERGY_PERF_BIAS_PERFORMANCE",
		// 6: "ENERGY_PERF_BIAS_NORMAL",
		// 15: "ENERGY_PERF_BIAS_POWERSAVE",
		0x000001b1: "MSR_IA32_PACKAGE_THERM_STATUS",
		// (1 << 0): "PACKAGE_THERM_STATUS_PROCHOT",
		// (1 << 10): "PACKAGE_THERM_STATUS_POWER_LIMIT",
		0x000001b2: "MSR_IA32_PACKAGE_THERM_INTERRUPT",
		/*
		   (1 << 0): "PACKAGE_THERM_INT_HIGH_ENABLE",
		   (1 << 1): "PACKAGE_THERM_INT_LOW_ENABLE",
		   (1 << 24): "PACKAGE_THERM_INT_PLN_ENABLE",
		   (1 << 15): "THERM_INT_THRESHOLD0_ENABLE",
		*/
		// 8: "THERM_SHIFT_THRESHOLD0",
		// (0x7f << 8): "THERM_MASK_THRESHOLD0",
		// (1 << 23): "THERM_INT_THRESHOLD1_ENABLE",
		// 16: "THERM_SHIFT_THRESHOLD1",
		// (0x7f << 16): "THERM_MASK_THRESHOLD1",
		// (1 << 6): "THERM_STATUS_THRESHOLD0",
		// (1 << 7): "THERM_LOG_THRESHOLD0",
		// (1 << 8): "THERM_STATUS_THRESHOLD1",
		// (1 << 9): "THERM_LOG_THRESHOLD1",
		// (1 << 0): "MSR_IA32_MISC_ENABLE_FAST_STRING",
		// (1 << 1): "MSR_IA32_MISC_ENABLE_TCC",
		// (1 << 7): "MSR_IA32_MISC_ENABLE_EMON",
		// (1 << 11): "MSR_IA32_MISC_ENABLE_BTS_UNAVAIL",
		// (1 << 12): "MSR_IA32_MISC_ENABLE_PEBS_UNAVAIL",
		// (1 << 16): "MSR_IA32_MISC_ENABLE_ENHANCED_SPEEDSTEP",
		// (1 << 18): "MSR_IA32_MISC_ENABLE_MWAIT",
		// (1 << 22): "MSR_IA32_MISC_ENABLE_LIMIT_CPUID",
		// (1 << 23): "MSR_IA32_MISC_ENABLE_XTPR_DISABLE",
		// (1 << 34): "MSR_IA32_MISC_ENABLE_XD_DISABLE",
		// (1 << 2): "MSR_IA32_MISC_ENABLE_X87_COMPAT",
		// (1 << 3): "MSR_IA32_MISC_ENABLE_TM1",
		// (1 << 4): "MSR_IA32_MISC_ENABLE_SPLIT_LOCK_DISABLE",
		// (1 << 6): "MSR_IA32_MISC_ENABLE_L3CACHE_DISABLE",
		// (1 << 8): "MSR_IA32_MISC_ENABLE_SUPPRESS_LOCK",
		// (1 << 9): "MSR_IA32_MISC_ENABLE_PREFETCH_DISABLE",
		// (1 << 10): "MSR_IA32_MISC_ENABLE_FERR",
		// (1 << 10): "MSR_IA32_MISC_ENABLE_FERR_MULTIPLEX",
		// (1 << 13): "MSR_IA32_MISC_ENABLE_TM2",
		// (1 << 19): "MSR_IA32_MISC_ENABLE_ADJ_PREF_DISABLE",
		// (1 << 20): "MSR_IA32_MISC_ENABLE_SPEEDSTEP_LOCK",
		// (1 << 24): "MSR_IA32_MISC_ENABLE_L1D_CONTEXT",
		// (1 << 37): "MSR_IA32_MISC_ENABLE_DCU_PREF_DISABLE",
		// (1 << 38): "MSR_IA32_MISC_ENABLE_TURBO_DISABLE",
		// (1 << 39): "MSR_IA32_MISC_ENABLE_IP_PREF_DISABLE",
		0x000006E0: "MSR_IA32_TSC_DEADLINE",
		0x00000180: "MSR_IA32_MCG_EAX",
		0x00000181: "MSR_IA32_MCG_EBX",
		0x00000182: "MSR_IA32_MCG_ECX",
		0x00000183: "MSR_IA32_MCG_EDX",
		0x00000184: "MSR_IA32_MCG_ESI",
		0x00000185: "MSR_IA32_MCG_EDI",
		0x00000186: "MSR_IA32_MCG_EBP",
		0x00000187: "MSR_IA32_MCG_ESP",
		0x00000188: "MSR_IA32_MCG_EFLAGS",
		0x00000189: "MSR_IA32_MCG_EIP",
		0x0000018a: "MSR_IA32_MCG_RESERVED",
		// 0x00000300: "MSR_P4_BPU_PERFCTR0",
		// 0x00000301: "MSR_P4_BPU_PERFCTR1",
		// 0x00000302: "MSR_P4_BPU_PERFCTR2",
		// 0x00000303: "MSR_P4_BPU_PERFCTR3",
		// 0x00000304: "MSR_P4_MS_PERFCTR0",
		// 0x00000305: "MSR_P4_MS_PERFCTR1",
		// 0x00000306: "MSR_P4_MS_PERFCTR2",
		// 0x00000307: "MSR_P4_MS_PERFCTR3",
		// 0x00000308: "MSR_P4_FLAME_PERFCTR0",
		// 0x00000309: "MSR_P4_FLAME_PERFCTR1",
		// 0x0000030a: "MSR_P4_FLAME_PERFCTR2",
		// 0x0000030b: "MSR_P4_FLAME_PERFCTR3",
		// 0x0000030c: "MSR_P4_IQ_PERFCTR0",
		// 0x0000030d: "MSR_P4_IQ_PERFCTR1",
		// 0x0000030e: "MSR_P4_IQ_PERFCTR2",
		// 0x0000030f: "MSR_P4_IQ_PERFCTR3",
		// 0x00000310: "MSR_P4_IQ_PERFCTR4",
		// 0x00000311: "MSR_P4_IQ_PERFCTR5",
		// 0x00000360: "MSR_P4_BPU_CCCR0",
		// 0x00000361: "MSR_P4_BPU_CCCR1",
		// 0x00000362: "MSR_P4_BPU_CCCR2",
		// 0x00000363: "MSR_P4_BPU_CCCR3",
		// 0x00000364: "MSR_P4_MS_CCCR0",
		// 0x00000365: "MSR_P4_MS_CCCR1",
		// 0x00000366: "MSR_P4_MS_CCCR2",
		// 0x00000367: "MSR_P4_MS_CCCR3",
		// 0x00000368: "MSR_P4_FLAME_CCCR0",
		// 0x00000369: "MSR_P4_FLAME_CCCR1",
		// 0x0000036a: "MSR_P4_FLAME_CCCR2",
		// 0x0000036b: "MSR_P4_FLAME_CCCR3",
		// 0x0000036c: "MSR_P4_IQ_CCCR0",
		// 0x0000036d: "MSR_P4_IQ_CCCR1",
		// 0x0000036e: "MSR_P4_IQ_CCCR2",
		// 0x0000036f: "MSR_P4_IQ_CCCR3",
		// 0x00000370: "MSR_P4_IQ_CCCR4",
		// 0x00000371: "MSR_P4_IQ_CCCR5",
		// 0x000003ca: "MSR_P4_ALF_ESCR0",
		// 0x000003cb: "MSR_P4_ALF_ESCR1",
		// 0x000003b2: "MSR_P4_BPU_ESCR0",
		// 0x000003b3: "MSR_P4_BPU_ESCR1",
		// 0x000003a0: "MSR_P4_BSU_ESCR0",
		// 0x000003a1: "MSR_P4_BSU_ESCR1",
		// 0x000003b8: "MSR_P4_CRU_ESCR0",
		// 0x000003b9: "MSR_P4_CRU_ESCR1",
		// 0x000003cc: "MSR_P4_CRU_ESCR2",
		// 0x000003cd: "MSR_P4_CRU_ESCR3",
		// 0x000003e0: "MSR_P4_CRU_ESCR4",
		// 0x000003e1: "MSR_P4_CRU_ESCR5",
		// 0x000003a8: "MSR_P4_DAC_ESCR0",
		// 0x000003a9: "MSR_P4_DAC_ESCR1",
		// 0x000003a4: "MSR_P4_FIRM_ESCR0",
		// 0x000003a5: "MSR_P4_FIRM_ESCR1",
		// 0x000003a6: "MSR_P4_FLAME_ESCR0",
		// 0x000003a7: "MSR_P4_FLAME_ESCR1",
		// 0x000003a2: "MSR_P4_FSB_ESCR0",
		// 0x000003a3: "MSR_P4_FSB_ESCR1",
		// 0x000003ba: "MSR_P4_IQ_ESCR0",
		// 0x000003bb: "MSR_P4_IQ_ESCR1",
		// 0x000003b4: "MSR_P4_IS_ESCR0",
		// 0x000003b5: "MSR_P4_IS_ESCR1",
		// 0x000003b6: "MSR_P4_ITLB_ESCR0",
		// 0x000003b7: "MSR_P4_ITLB_ESCR1",
		// 0x000003c8: "MSR_P4_IX_ESCR0",
		// 0x000003c9: "MSR_P4_IX_ESCR1",
		// 0x000003aa: "MSR_P4_MOB_ESCR0",
		// 0x000003ab: "MSR_P4_MOB_ESCR1",
		// 0x000003c0: "MSR_P4_MS_ESCR0",
		// 0x000003c1: "MSR_P4_MS_ESCR1",
		// 0x000003ac: "MSR_P4_PMH_ESCR0",
		// 0x000003ad: "MSR_P4_PMH_ESCR1",
		// 0x000003bc: "MSR_P4_RAT_ESCR0",
		// 0x000003bd: "MSR_P4_RAT_ESCR1",
		// 0x000003ae: "MSR_P4_SAAT_ESCR0",
		// 0x000003af: "MSR_P4_SAAT_ESCR1",
		// 0x000003be: "MSR_P4_SSU_ESCR0",
		// 0x000003bf: "MSR_P4_SSU_ESCR1",
		// 0x000003c2: "MSR_P4_TBPU_ESCR0",
		// 0x000003c3: "MSR_P4_TBPU_ESCR1",
		// 0x000003c4: "MSR_P4_TC_ESCR0",
		// 0x000003c5: "MSR_P4_TC_ESCR1",
		// 0x000003b0: "MSR_P4_U2L_ESCR0",
		// 0x000003b1: "MSR_P4_U2L_ESCR1",
		// 0x000003f2: "MSR_P4_PEBS_MATRIX_VERT",
		0x00000309: "MSR_CORE_PERF_FIXED_CTR0",
		0x0000030a: "MSR_CORE_PERF_FIXED_CTR1",
		0x0000030b: "MSR_CORE_PERF_FIXED_CTR2",
		0x0000038d: "MSR_CORE_PERF_FIXED_CTR_CTRL",
		0x0000038e: "MSR_CORE_PERF_GLOBAL_STATUS",
		0x0000038f: "MSR_CORE_PERF_GLOBAL_CTRL",
		0x00000390: "MSR_CORE_PERF_GLOBAL_OVF_CTRL",
		0x00001900: "MSR_GEODE_BUSCONT_CONF0",
		0x00000480: "MSR_IA32_VMX_BASIC",
		0x00000481: "MSR_IA32_VMX_PINBASED_CTLS",
		0x00000482: "MSR_IA32_VMX_PROCBASED_CTLS",
		0x00000483: "MSR_IA32_VMX_EXIT_CTLS",
		0x00000484: "MSR_IA32_VMX_ENTRY_CTLS",
		0x00000485: "MSR_IA32_VMX_MISC",
		0x00000486: "MSR_IA32_VMX_CR0_FIXED0",
		0x00000487: "MSR_IA32_VMX_CR0_FIXED1",
		0x00000488: "MSR_IA32_VMX_CR4_FIXED0",
		0x00000489: "MSR_IA32_VMX_CR4_FIXED1",
		0x0000048a: "MSR_IA32_VMX_VMCS_ENUM",
		0x0000048b: "MSR_IA32_VMX_PROCBASED_CTLS2",
		0x0000048c: "MSR_IA32_VMX_EPT_VPID_CAP",
		0x0000048d: "MSR_IA32_VMX_TRUE_PINBASED_CTLS",
		0x0000048e: "MSR_IA32_VMX_TRUE_PROCBASED_CTLS",
		0x0000048f: "MSR_IA32_VMX_TRUE_EXIT_CTLS",
		0x00000490: "MSR_IA32_VMX_TRUE_ENTRY_CTLS",
		// 32: "VMX_BASIC_VMCS_SIZE_SHIFT",
		// 0x0001000000000000: "VMX_BASIC_64",
		// 50: "VMX_BASIC_MEM_TYPE_SHIFT",
		// 0x003c000000000000: "VMX_BASIC_MEM_TYPE_MASK",
		// 6: "VMX_BASIC_MEM_TYPE_WB",
		// 0x0040000000000000: "VMX_BASIC_INOUT",
		0xc0010114: "MSR_VM_CR",
		0xc0010115: "MSR_VM_IGNNE",
		0xc0010117: "MSR_VM_HSAVE_PA",
		0x802:      "MSR_APIC_ID",
		0x803:      "MSR_APIC_VERSION",
		0x808:      "MSR_APIC_TPR",
		0x80b:      "MSR_APIC_EOI",
		0x80d:      "MSR_APIC_LDR",
		0x80f:      "MSR_APIC_SVR",
		0x810:      "MSR_APIC_ISR0",
		0x811:      "MSR_APIC_ISR1",
		0x812:      "MSR_APIC_ISR2",
		0x813:      "MSR_APIC_ISR3",
		0x814:      "MSR_APIC_ISR4",
		0x815:      "MSR_APIC_ISR5",
		0x816:      "MSR_APIC_ISR6",
		0x817:      "MSR_APIC_ISR7",
		0x818:      "MSR_APIC_TMR0",
		0x820:      "MSR_APIC_IRR0",
		0x828:      "MSR_APIC_ESR",
		0x82F:      "MSR_APIC_LVT_CMCI",
		0x830:      "MSR_APIC_ICR",
		0x832:      "MSR_APIC_LVT_TIMER",
		0x833:      "MSR_APIC_LVT_THERMAL",
		0x834:      "MSR_APIC_LVT_PCINT",
		0x835:      "MSR_APIC_LVT_LINT0",
		0x836:      "MSR_APIC_LVT_LINT1",
		0x837:      "MSR_APIC_LVT_ERROR",
		0x838:      "MSR_APIC_ICR_TIMER",
		0x839:      "MSR_APIC_CCR_TIMER",
		0x83e:      "MSR_APIC_DCR_TIMER",
		0x83f:      "MSR_APIC_SELF_IPI",
		0xda0:      "MSR_IA32_XSS",
	}
)

func main() {
	if len(os.Args[1:]) < 1 { 
		fmt.Fprintf(os.Stderr, "usage: genregs reg [reg ... ], e.g. genregs MSR_GSBASE or genregs MSR_GSBASE MSR_FSBASE\n")
		fmt.Fprintf(os.Stderr, "usually appended to the name.sed script\n")
		os.Exit(1)
	}
	for _, i := range os.Args[1:] {
		v, ok := bsdregs[i]
		if !ok {
			fmt.Fprintf(os.Stderr, "no matching register for %v/%v\n", i, v)
			continue
		}
		fmt.Printf("sed -i 's/%v/%v/g' $*\n", i, aregs[bsdregs[i]])
	}
}
